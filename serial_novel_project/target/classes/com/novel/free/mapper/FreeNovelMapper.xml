<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	<mapper namespace="com.novel.free.mapper.FreeNovelMapper">
<sql id="search">
	<!-- 동적 쿼리문이 들어올 자리  -->
	<if test="searchType != null">
		<if test="searchType == 't'.toString()">
			(TITLE like '%'||#{keyword}||'%') AND
		</if>
		<if test="searchType == 'c'.toString()">
			(CONTENT like '%'||#{keyword}||'%') AND
		</if>
		<if test="searchType == 'w'.toString()">
			(WRITER like '%'||#{keyword}||'%') AND
		</if>
		<if test="searchType == 'tc'.toString()">
		   ((TITLE like '%'||#{keyword}||'%')
		    	OR
			(CONTENT like '%'||#{keyword}||'%')) AND
		</if>
		<if test="searchType == 'cw'.toString()">
		   ((CONTENT like '%'||#{keyword}||'%')
		    	OR
			(WRITER like '%'||#{keyword}||'%')) AND
		</if>
		<if test="searchType == 'tcw'.toString()">
		   ((TITLE like '%'||#{keyword}||'%')
		    	OR
		    (CONTENT like '%'||#{keyword}||'%')
		    	OR
			(WRITER like '%'||#{keyword}||'%')) AND
		</if>
		
	</if>
	</sql>
	<select id="getList" resultType="com.novel.free.domain.FreeNovelVO">
	<![CDATA[ 
	SELECT * FROM 
	(SELECT /* + INDEX_DESC(free_tbl free_num) */
	rownum rn, free_tbl.* FROM free_tbl WHERE 
	
	]]>
	<!-- SELECT free_tbl.free_content FROM free_tbl INNER JOIN 
	novel_tbl ON free_tbl.novel_num = novel_tbl.novel_num; -->
	<!-- SELECT f.* FROM free_tbl f INNER JOIN 
	novel_tbl n ON f.novel_num = n.novel_num; 
	free_tbl f , novel_tbl n  각 테이블을 f, n 으로 표현할 수 있음.
	-->
	<include refid="search"></include>
	
	<![CDATA[
	
	rownum <= #{pageEnd})
	WHERE rn > #{pageStart}
	
	]]>
	
	
	
	</select>
	
	</mapper>